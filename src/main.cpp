/**
 * Blink
 *
 * Turns on an LED on for one second,
 * then off for one second, repeatedly.
 */
#include "Arduino.h"
#include "Mouse.h"

#ifndef LED_BUILTIN
#define LED_BUILTIN 13
#endif

#define TIME_MULTIPLIER 1

#define DELAY_AFTER 5000

// another dick
#define POSITION_COUNT 246
int positions [POSITION_COUNT][3] = {
  {0,300,715},
  {290,297,715},
  {305,294,718},
  {322,291,719},
  {339,287,721},
  {355,283,725},
  {372,277,728},
  {388,269,730},
  {405,262,731},
  {421,256,733},
  {439,251,734},
  {455,240,735},
  {472,233,736},
  {488,226,737},
  {504,221,737},
  {521,215,737},
  {539,207,737},
  {555,201,737},
  {572,196,737},
  {588,192,737},
  {605,190,737},
  {621,187,735},
  {638,183,731},
  {655,178,724},
  {672,174,721},
  {689,171,716},
  {704,168,708},
  {722,166,700},
  {738,165,691},
  {755,164,682},
  {771,164,671},
  {788,164,662},
  {806,164,652},
  {821,164,644},
  {838,167,632},
  {855,170,623},
  {872,174,616},
  {887,179,608},
  {905,186,599},
  {921,192,593},
  {939,197,588},
  {956,203,584},
  {972,213,580},
  {989,219,577},
  {1005,226,575},
  {1022,231,572},
  {1038,234,572},
  {1055,238,572},
  {1072,243,574},
  {1088,250,581},
  {1105,260,591},
  {1122,268,597},
  {1139,275,603},
  {1154,280,609},
  {1172,283,615},
  {1188,288,623},
  {1205,291,631},
  {1222,296,638},
  {1238,299,645},
  {1255,301,649},
  {1272,302,653},
  {1289,303,657},
  {1306,303,660},
  {1321,304,664},
  {1338,304,670},
  {1354,304,675},
  {1372,304,677},
  {1388,304,679},
  {1521,304,672},
  {1539,304,666},
  {1555,304,660},
  {1573,304,651},
  {1588,304,639},
  {1605,304,626},
  {1622,304,613},
  {1638,304,594},
  {1654,304,589},
  {1672,307,571},
  {1688,308,563},
  {1705,310,553},
  {1722,312,544},
  {1738,313,533},
  {1755,313,523},
  {1771,315,513},
  {1788,318,503},
  {1805,320,494},
  {1821,323,484},
  {1839,325,475},
  {1855,327,462},
  {1872,328,455},
  {1887,330,446},
  {1905,331,436},
  {1922,334,427},
  {1938,336,419},
  {1955,337,412},
  {1972,342,405},
  {1988,344,398},
  {2004,347,392},
  {2022,350,385},
  {2039,352,378},
  {2054,356,370},
  {2072,359,362},
  {2088,361,357},
  {2106,365,350},
  {2122,368,345},
  {2139,373,340},
  {2154,378,331},
  {2172,384,325},
  {2189,392,316},
  {2205,400,310},
  {2221,408,305},
  {2238,415,300},
  {2255,425,294},
  {2271,433,290},
  {2289,440,287},
  {2305,447,283},
  {2322,452,282},
  {2338,457,279},
  {2355,461,279},
  {2372,465,278},
  {2422,469,278},
  {2439,479,285},
  {2455,493,297},
  {2471,498,303},
  {2489,505,312},
  {2505,508,320},
  {2521,514,328},
  {2539,515,336},
  {2555,516,341},
  {2572,517,348},
  {2588,517,357},
  {2605,517,365},
  {2621,517,377},
  {2638,517,389},
  {2655,517,405},
  {2671,516,415},
  {2689,514,428},
  {2705,512,441},
  {2722,508,455},
  {2738,503,470},
  {2754,502,481},
  {2772,499,491},
  {2788,496,496},
  {2805,493,502},
  {2821,491,510},
  {2838,489,516},
  {2855,484,526},
  {2871,478,539},
  {2888,471,546},
  {2905,468,551},
  {2922,464,558},
  {2938,459,565},
  {2955,454,572},
  {2971,448,579},
  {2988,441,586},
  {3006,433,598},
  {3021,425,609},
  {3038,418,619},
  {3055,411,628},
  {3072,402,638},
  {3088,397,647},
  {3105,390,654},
  {3122,384,662},
  {3139,378,670},
  {3156,372,676},
  {3172,366,682},
  {3189,361,686},
  {3205,357,689},
  {3389,357,691},
  {3405,359,692},
  {3422,364,691},
  {3438,374,690},
  {3455,390,687},
  {3472,402,687},
  {3489,414,686},
  {3504,423,686},
  {3521,432,686},
  {3539,440,686},
  {3555,447,686},
  {3571,450,686},
  {3588,451,686},
  {3605,453,686},
  {3622,456,689},
  {3638,459,695},
  {3654,462,701},
  {3672,464,711},
  {3688,465,716},
  {3705,465,721},
  {3722,465,727},
  {3738,465,733},
  {3755,465,738},
  {3771,462,746},
  {3789,458,752},
  {3805,454,757},
  {3821,451,762},
  {3838,448,767},
  {3855,441,773},
  {3872,433,778},
  {3888,428,780},
  {3906,422,782},
  {3921,416,784},
  {3938,410,785},
  {3956,404,785},
  {3972,399,786},
  {3988,394,787},
  {4005,389,787},
  {4022,384,787},
  {4038,379,787},
  {4055,371,787},
  {4071,368,787},
  {4089,367,787},
  {4106,364,787},
  {4122,359,785},
  {4139,356,783},
  {4155,351,780},
  {4172,349,779},
  {4189,347,776},
  {4205,346,775},
  {4222,343,772},
  {4239,339,769},
  {4255,335,764},
  {4271,333,761},
  {4288,331,758},
  {4306,329,755},
  {4321,326,752},
  {4339,325,750},
  {4355,323,748},
  {4372,322,745},
  {4388,321,744},
  {4405,320,742},
  {4421,318,739},
  {4439,316,734},
  {4455,315,731},
  {4471,314,729},
  {4489,313,728},
  {4510,313,727},
  {4522,312,724},
  {4539,311,721},
  {4554,309,717},
  {4572,308,716},
  {4589,308,715},
  {4722,306,714},
  {4889,305,714},
  {5071,303,714},
  {5239,301,714},
  {5255,299,714},
};

/* // it's a dick! */
/* #define POSITION_COUNT 92 */
/* int positions [POSITION_COUNT] [3] = { */


/*   {113,142,789}, */
/*   {130,137,786}, */
/*   {148,128,778}, */
/*   {164,117,769}, */
/*   {181,109,758}, */
/*   {197,103,746}, */
/*   {214,101,737}, */
/*   {230,100,725}, */
/*   {248,105,716}, */
/*   {264,112,704}, */
/*   {281,121,694}, */
/*   {297,132,685}, */
/*   {315,144,680}, */
/*   {330,154,678}, */
/*   {347,164,677}, */
/*   {363,172,677}, */
/*   {380,178,680}, */
/*   {396,184,698}, */
/*   {414,187,721}, */
/*   {431,192,753}, */
/*   {446,192,763}, */
/*   {464,192,764}, */
/*   {481,192,766}, */
/*   {531,191,766}, */
/*   {546,191,751}, */
/*   {564,191,731}, */
/*   {580,196,701}, */
/*   {597,209,676}, */
/*   {614,231,649}, */
/*   {631,284,609}, */
/*   {648,318,588}, */
/*   {664,341,576}, */
/*   {681,355,569}, */
/*   {697,358,569}, */
/*   {714,360,569}, */
/*   {730,363,569}, */
/*   {748,369,582}, */
/*   {764,374,606}, */
/*   {781,375,642}, */
/*   {797,373,677}, */
/*   {814,359,704}, */
/*   {830,330,725}, */
/*   {848,307,736}, */
/*   {864,288,746}, */
/*   {880,277,757}, */
/*   {897,275,758}, */
/*   {998,275,757}, */
/*   {1014,275,756}, */
/*   {1031,279,753}, */
/*   {1047,284,753}, */
/*   {1064,294,753}, */
/*   {1081,308,753}, */
/*   {1097,323,753}, */
/*   {1114,334,756}, */
/*   {1131,346,768}, */
/*   {1147,354,781}, */
/*   {1164,362,795}, */
/*   {1180,365,805}, */
/*   {1198,365,806}, */
/*   {1214,365,809}, */
/*   {1231,358,813}, */
/*   {1248,346,815}, */
/*   {1264,329,818}, */
/*   {1281,314,819}, */
/*   {1297,302,819}, */
/*   {1314,293,818}, */
/*   {1331,284,811}, */
/*   {1348,273,806}, */
/*   {1364,264,798}, */
/*   {1381,258,797}, */
/*   {1397,254,795}, */
/*   {1414,252,795}, */
/*   {1464,249,794}, */
/*   {1481,246,793}, */
/*   {1497,240,791}, */
/*   {1515,232,787}, */
/*   {1530,220,781}, */
/*   {1548,213,779}, */
/*   {1564,208,778}, */
/*   {1581,207,777}, */
/*   {1597,206,777}, */
/*   {1614,203,777}, */
/*   {1631,199,776}, */
/*   {1648,194,776}, */
/*   {1663,193,776}, */
/*   {1697,190,776}, */
/*   {1714,187,776}, */
/*   {1731,181,776}, */
/*   {1747,180,775}, */
/*   {1764,179,775}, */
/*   {1864,178,775}, */
/*   {1980,175,775} */
/* }; */

/* // infinity symbol */
/* #define POSITION_COUNT 181 */
/* int positions [POSITION_COUNT] [3] = { */
/*   {0,436,641}, */
/*   {256,433,644}, */
/*   {272,427,650}, */
/*   {289,421,657}, */
/*   {306,415,662}, */
/*   {322,409,666}, */
/*   {339,404,672}, */
/*   {356,400,676}, */
/*   {372,396,679}, */
/*   {390,391,683}, */
/*   {405,387,686}, */
/*   {423,381,692}, */
/*   {438,374,698}, */
/*   {456,365,705}, */
/*   {473,358,708}, */
/*   {488,351,711}, */
/*   {506,342,716}, */
/*   {522,332,719}, */
/*   {539,321,722}, */
/*   {556,309,725}, */
/*   {572,296,727}, */
/*   {589,281,731}, */
/*   {605,270,733}, */
/*   {623,257,736}, */
/*   {640,242,740}, */
/*   {655,232,741}, */
/*   {673,220,743}, */
/*   {689,213,744}, */
/*   {706,206,745}, */
/*   {722,200,745}, */
/*   {738,193,745}, */
/*   {756,188,745}, */
/*   {772,183,745}, */
/*   {789,176,743}, */
/*   {806,171,737}, */
/*   {823,167,732}, */
/*   {840,164,728}, */
/*   {855,160,721}, */
/*   {873,158,710}, */
/*   {888,157,703}, */
/*   {906,156,694}, */
/*   {923,155,684}, */
/*   {939,154,677}, */
/*   {957,154,668}, */
/*   {973,154,660}, */
/*   {989,154,649}, */
/*   {1006,154,640}, */
/*   {1023,154,628}, */
/*   {1040,155,618}, */
/*   {1055,160,607}, */
/*   {1073,162,597}, */
/*   {1088,165,589}, */
/*   {1106,169,579}, */
/*   {1122,172,572}, */
/*   {1139,175,563}, */
/*   {1156,180,555}, */
/*   {1173,184,547}, */
/*   {1189,188,541}, */
/*   {1205,194,534}, */
/*   {1222,200,529}, */
/*   {1239,205,525}, */
/*   {1255,217,517}, */
/*   {1273,227,514}, */
/*   {1289,236,513}, */
/*   {1307,244,512}, */
/*   {1322,253,512}, */
/*   {1339,263,512}, */
/*   {1356,272,512}, */
/*   {1372,280,514}, */
/*   {1390,290,520}, */
/*   {1406,303,526}, */
/*   {1423,315,532}, */
/*   {1439,329,539}, */
/*   {1456,339,545}, */
/*   {1472,349,552}, */
/*   {1489,356,558}, */
/*   {1506,362,563}, */
/*   {1522,368,570}, */
/*   {1539,373,575}, */
/*   {1556,377,581}, */
/*   {1573,380,586}, */
/*   {1589,382,589}, */
/*   {1607,385,594}, */
/*   {1623,388,598}, */
/*   {1639,393,607}, */
/*   {1655,398,612}, */
/*   {1672,405,621}, */
/*   {1689,410,626}, */
/*   {1706,416,633}, */
/*   {1723,424,641}, */
/*   {1739,431,646}, */
/*   {1756,438,651}, */
/*   {1772,445,656}, */
/*   {1789,451,661}, */
/*   {1806,457,664}, */
/*   {1822,464,671}, */
/*   {1840,470,676}, */
/*   {1856,481,685}, */
/*   {1873,490,692}, */
/*   {1888,500,700}, */
/*   {1906,510,707}, */
/*   {1923,521,712}, */
/*   {1939,532,717}, */
/*   {1956,544,723}, */
/*   {1972,558,727}, */
/*   {1989,571,730}, */
/*   {2005,585,730}, */
/*   {2022,598,730}, */
/*   {2038,610,730}, */
/*   {2056,622,730}, */
/*   {2072,637,730}, */
/*   {2089,644,728}, */
/*   {2105,650,725}, */
/*   {2122,657,719}, */
/*   {2139,661,713}, */
/*   {2156,668,703}, */
/*   {2172,673,695}, */
/*   {2189,676,687}, */
/*   {2205,679,678}, */
/*   {2222,684,668}, */
/*   {2239,689,659}, */
/*   {2256,692,647}, */
/*   {2272,695,631}, */
/*   {2289,698,620}, */
/*   {2306,698,611}, */
/*   {2323,698,601}, */
/*   {2339,698,592}, */
/*   {2356,698,584}, */
/*   {2372,697,579}, */
/*   {2388,696,574}, */
/*   {2406,694,569}, */
/*   {2423,692,565}, */
/*   {2439,690,561}, */
/*   {2456,684,554}, */
/*   {2472,682,551}, */
/*   {2489,677,548}, */
/*   {2506,676,547}, */
/*   {2523,673,546}, */
/*   {2539,669,544}, */
/*   {2556,663,543}, */
/*   {2573,653,543}, */
/*   {2589,644,543}, */
/*   {2606,634,543}, */
/*   {2623,622,543}, */
/*   {2639,613,543}, */
/*   {2656,603,543}, */
/*   {2673,587,549}, */
/*   {2689,576,555}, */
/*   {2705,567,559}, */
/*   {2722,556,564}, */
/*   {2739,548,567}, */
/*   {2755,542,572}, */
/*   {2773,536,576}, */
/*   {2788,531,580}, */
/*   {2806,526,584}, */
/*   {2822,519,590}, */
/*   {2839,514,593}, */
/*   {2855,509,597}, */
/*   {2872,504,601}, */
/*   {2890,497,606}, */
/*   {2905,493,607}, */
/*   {2923,488,609}, */
/*   {2939,483,612}, */
/*   {2956,480,613}, */
/*   {2972,476,615}, */
/*   {2989,472,616}, */
/*   {3006,469,618}, */
/*   {3022,467,620}, */
/*   {3040,465,621}, */
/*   {3056,462,622}, */
/*   {3072,456,625}, */
/*   {3088,454,627}, */
/*   {3105,451,629}, */
/*   {3123,448,630}, */
/*   {3139,447,631}, */
/*   {3156,446,632}, */
/*   {3189,444,634}, */
/*   {3205,443,634}, */
/*   {3222,440,637}, */
/*   {3238,439,638}, */
/*   {3273,438,638} */
/* }; */

int curX;
int curY;
int step, oldStep;

void setup()
{
  pinMode(LED_BUILTIN, OUTPUT);
  Serial.begin(9600);
  Mouse.begin();
  step = 0;
  curX = positions[step][1];
  curX = positions[step][2];
  delay(2000);
}

int getTime(int step)
{
  return positions[step][0];
}

int getX(int step)
{
  return positions[step][1];
}

int getY(int step)
{
  return positions[step][2];
}

void debugDiff(int x, int y, int t)
{
  Serial.print("xDiff: ");
  Serial.print(x);
  Serial.print("yDiff: ");
  Serial.print(y);
  Serial.print("tDiff: ");
  Serial.print(t);
  Serial.print("\n");
}

void loop()
{
  // invariant: we have just moved to position[step] and have done no waiting
  oldStep = step;
  step = (step + 1) % POSITION_COUNT;
  // wait
  int diffT;
  diffT = getTime(step) - getTime(oldStep);
  if(diffT < 0) {
    diffT = DELAY_AFTER;
  } else {
    diffT = diffT * TIME_MULTIPLIER;
  }
  delay(diffT);

  // move
  int diffX, diffY;
  diffX = (getX(step) - getX(oldStep));
  diffY = (getY(step) - getY(oldStep));
  if ((char) diffX != diffX || (char) diffY != diffY) {
    exit(1);
  } debugDiff(diffX, diffY, diffT);
  Mouse.move((char) diffX, (char) diffY, (char) 0);
}
